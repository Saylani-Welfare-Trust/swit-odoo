<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="disbursement_request_view_tree" model="ir.ui.view">
        <field name="name">disbursement.request.view.tree</field>
        <field name="model">disbursement.request</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" />
                <field name="donee_id" string="Donee" />
                <field name="disbursement_date" string="Date" />
                <field name="state" widget="badge" decoration-info="state == 'approved'" decoration-success="state == 'disbursed'" decoration-warning="state == 'draft'" />
            </tree>
        </field>
    </record>

    <record id="disbursement_request_view_form" model="ir.ui.view">
        <field name="name">disbursement.request.view.form</field>
        <field name="model">disbursement.request</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="action_to_approve" invisible="state != 'draft'" string="Move to HOD" type="object" class="oe_highlight"/>
                    <button name="action_mem_approve" invisible="state != 'to_approve'" string="Move to Member" type="object" class="oe_highlight"/>
                    <button name="action_approved" invisible="state != 'mem_approve'" string="Approve" type="object" class="oe_highlight"/>
                    <button name="action_rejected" invisible="state != 'to_approve'" string="Reject" type="object"/>
                    <button name="action_rejected" invisible="state != 'mem_approve'" string="Reject" type="object"/>
                    <button name="action_revert" invisible="state != 'to_approve'" string="Revert" type="object"/>
                    <button name="action_revert" invisible="state != 'mem_approve'" string="Revert" type="object"/>
                    <!-- <button name="action_proceed" invisible="state != 'approved'" string="Proceed" type="object" class="oe_highlight"/> -->
                    <button name="print_disbursement_slip" invisible="state not in ('approved', 'paid')" string="Receipt" type="object" class="oe_highlight"/>
                    <button name="action_create_recurring_order" invisible="state != 'approved'" string="Create Recurring Orders" type="object" class="oe_highlight"/>
                    <!-- <button name="action_disbursed" invisible="state != 'waiting_for_approval'" string="Disbursed" type="object" class="oe_highlight"/> -->

                    <field name="state" widget="statusbar" statusbar_visible="draft,to_approve,mem_approve,approved,disbursed,rejected"/>
                    <!-- <button name="print_disbursement_slip" invisible="state not in ('waiting_for_approval', 'paid')" string="Receipt" type="object" class="oe_highlight"/>
                    <button name="action_create_recurring_order" invisible="state != 'waiting_for_approval' or order_type != 'recurring'" string="Create Recurring Orders" type="object" class="oe_highlight"/>

                    <field name="state" widget="statusbar" statusbar_visible="draft,to_approve,mem_approve,approved,waiting_for_approval,disbursed,rejected"/> -->
                </header>

                <sheet>
                    <div class="oe_title">
                        <label for="name"/>
                        <h1><field name="name" string="Voucher Number" class="oe_inline" readonly="1" /></h1>
                    </div>
                    
                    <group>
                        <group name="disbursement_request_col_1">
                            <field name="donee_id" string="Donee" domain="[('is_donee', '=', True), ('registration_category', '=', 'donee')]" options="{'no_create': True, 'no_edit': True, 'no_open': True}" required="1" readonly="state in ['waiting_for_approval', 'recurring_order','disbursed']" />
                            <field name="inquiry_office_id" string="Inquiry Officer" domain="[('category_ids', 'in', [3])]" options="{'no_create': True, 'no_edit': True, 'no_open': True}" required="1" readonly="state in ['waiting_for_approval', 'recurring_order','disbursed']" />
                            <field name="cnic_no" readonly="1" />
                            <field name="cnic_expiration_date" readonly="1" />
                            <field name="father_name" readonly="state in ['waiting_for_approval', 'recurring_order','disbursed']" />
                            <field name="father_cnic" readonly="state in ['waiting_for_approval', 'recurring_order','disbursed']" />
                            <field name="hod_remarks" readonly="state in ['waiting_for_approval', 'recurring_order','disbursed']" />
                            <field name="mem_remarks" readonly="state in ['waiting_for_approval', 'recurring_order','disbursed']" />
                        </group>
                        <group name="disbursement_request_col_2">
                            <field name="attachment_name" invisible="1"/>
                            <field name="attachment_id" filename="attachment_name" readonly="state != 'draft'" required="1"/>
                            <field name="frc_name" invisible="1"/>
                            <field name="frc_id" filename="frc_name" readonly="state != 'draft'" required="1"/>
                            <field name="electricity_bill_name" invisible="1"/>
                            <field name="electricity_bill_id" filename="electricity_bill_name" readonly="state != 'draft'" required="1"/>
                            <field name="gas_bill_name" invisible="1"/>
                            <field name="gas_bill_id" filename="gas_bill_name" readonly="state != 'draft'" required="1"/>
                            <field name="family_cnic_name" invisible="1"/>
                            <field name="family_cnic_id" filename="family_cnic_name" readonly="state != 'draft'" required="1"/>
                            <field name="old_system_record" string="Old System ID" readonly="state != 'draft'"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="disbursement_request_line" string="Disbursement Lines">
                            <field name="disbursement_request_line_ids">
                                <tree editable="bottom">
                                    <field name="disbursement_category_name" column_invisible="1" />
                                    <field name="product_domain" column_invisible="1" />
                                    <field name="order_type" required="1" />
                                    <field name="recurring_duration" required="order_type == 'recurring'" readonly="order_type != 'recurring'" />
                                    <field name="disbursement_category_id" string="Application Category" options="{'no_create': True, 'no_edit': True, 'no_open': True}" required="1" />
                                    <field name="disbursement_type_id" domain="[('disbursement_category_id', '=', disbursement_category_id), ('order_type', 'in', [order_type, 'both'])]" string="Application Type" options="{'no_create': True, 'no_edit': True, 'no_open': True}" required="1" />
                                    <field name="product_id" domain="product_domain" string="Products" options="{'no_create': True, 'no_edit': True, 'no_open': True}" required="1" />
                                    <field name="warehouse_loc_id" domain="[('usage', '=', 'internal'),('replenish_location', '=', True)]" string="Warehouse/Location" options="{'no_create': True, 'no_edit': True, 'no_open': True}" readonly="disbursement_category_name != 'In Kind'" required="disbursement_category_name == 'In Kind'" />
                                    <field name="collection_point" />
                                    <field name="branch_id" string="Branch" options="{'no_create': True, 'no_edit': True, 'no_open': True}" readonly="collection_point != 'branch'" required="collection_point == 'branch'" domain="[('child_ids', '=', False)]" />
                                    <field name="collection_date" />
                                    <field name="marriage_date" readonly="disbursement_category_name != 'Marriage / Wedding'" />
                                    <field name="disbursement_amount" />
                                </tree>
                            </field>
                        </page>
                        <page name="employment_info" string="Employment Information">
                            <group>
                                <group name="employment_info_col_1">
                                    <field name="company_name" />
                                    <field name="company_address" />
                                    <field name="company_phone_no" />
                                </group>
                                <group name="employment_info_col_2">
                                    <field name="designation" />
                                    <field name="duration_of_service" />
                                    <field name="monthly_salary" />
                                </group>
                            </group>
                        </page>
                        <page name="education_info" string="Education Information">
                            <field name="welfare_qualification_ids">
                                <tree editable="bottom">
                                    <field name="examination" />
                                    <field name="school_uni_center" />
                                    <field name="board" />
                                    <field name="percentage" />
                                    <field name="year" />
                                </tree>
                            </field>
                        </page>
                        <page name="house_ownership_residency_details" string="House Ownership / Residency Details">
                            <group>
                                <group name="house_ownership_residency_details_col_1">
                                    <field name="residence_type" />
                                    <field name="home_phone_no" />
                                    <field name="rental_shared_duration" />
                                    <field name="electricity_bill" />
                                    <field name="gas_bill" />
                                </group>
                                <group name="house_ownership_residency_details_col_2">
                                    <field name="landlord_owner" />
                                    <field name="cnic_no_landlord" />
                                    <field name="mobile_no_landlord" />
                                    <field name="home_other_info" />
                                    <field name="per_month_rent" />
                                </group>
                            </group>
                        </page>
                        <page name="other_finance" string="Other Finance">
                            <group>
                                <group name="other_finance_col_1">
                                    <field name="monthly_income" />
                                    <field name="bank_account" />
                                    <field name="bank_name" invisible="bank_account == 'no'" />
                                    <field name="account_no" invisible="bank_account == 'no'" />
                                </group>
                                <group name="other_finance_col_2">
                                    <field name="monthly_household_expense" />
                                    <field name="other_loan" />
                                    <field name="institute_name" invisible="other_loan == 'no'" />
                                    <field name="outstanding_amount" invisible="other_loan == 'no'" />
                                </group>
                            </group>
                        </page>
                        <page name="other_information" string="Other Information">
                            <group>
                                <group name="other_information_col_1">
                                    <field name="aid_from_other_organization" />
                                    <field name="details_1" />
                                </group>
                                <group name="other_information_col_2">
                                    <field name="have_applied_swit" />
                                    <field name="details_2" />
                                </group>
                            </group>
                        </page>
                        <page name="request_details" string="Request Details">
                            <group>
                                <group name="request_details_col_1">
                                    <field name="tenure_kifalat_madad_expected" />
                                </group>
                            </group>
                        </page>
                        <page name="guarantor_information" string="Guarantor Information">
                            <field name="guarantor_information_ids">
                                <tree editable="bottom">
                                    <field name="name" />
                                    <field name="father_spouse_name" />
                                    <field name="cnic_no" />
                                    <field name="relation" />
                                    <field name="address" />
                                    <field name="mobile" />
                                    <field name="landline_no" />
                                </tree>
                            </field>
                        </page>
                        <page name="family_member" string="Family Details">
                            <group>
                                <group name="family_member_col_1">
                                    <field name="dependent_person" />
                                </group>
                                <group name="family_member_col_2">
                                    <field name="household_member" />
                                </group>
                            </group>
                            <field name="family_information_ids">
                                <tree editable="bottom">
                                    <field name="complete_name" />
                                    <field name="age" />
                                    <field name="relation" />
                                    <field name="cnic_bform" />
                                    <field name="education" />
                                    <field name="monthly_income" />
                                </tree>
                            </field>
                        </page>
                        <page name="recurring_disbursement_request" string="Recurring Request" invisible="state != 'recurring_order'">
                            <field name="recurring_disbursement_request_ids" readonly="1">
                                <tree>
                                    <field name="disbursement_category_id" options="{'no_create': True, 'no_edit': True, 'no_open': True}" string="Application Category" />
                                    <field name="disbursement_type_id" options="{'no_create': True, 'no_edit': True, 'no_open': True}" string="Application Type" />
                                    <field name="product_id" options="{'no_create': True, 'no_edit': True, 'no_open': True}" string="Product" />
                                    <field name="collection_point" />
                                    <field name="branch_id" options="{'no_create': True, 'no_edit': True, 'no_open': True}" string="Branch" />
                                    <field name="collection_date" />
                                    <field name="state" widget="badge" decoration-success="state == 'disbursed'" decoration-warning="state == 'draft'" />
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="disbursement_request_action" model="ir.actions.act_window">
        <field name="name">Disbursement Request</field>
        <field name="res_model">disbursement.request</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Let's Create a new Disbursement Request...
            </p>
        </field>
    </record>

</odoo>
